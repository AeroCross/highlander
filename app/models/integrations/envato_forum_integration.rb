module Integrations
  class EnvatoForumIntegration < Base

    def execute
      # for each user in the clan (available from #current_clan)
      # fetch from endpoint http://http://marketplace.envato.com/api/v1/messages:<ENVATO_SERVICE_USERNAME>.json
      # parse response, see sample in __END__
      # for each message, create a hash { message_id: "some_id", "envato_username": "ENVATO_SERVICE_USERNAME" }
      # post that hash using post_metric(:forum_post, your_message_hash)
    end
  end
end




__END__

{"messages":[{"message_id":"435404","thread_id":"44167","thread_subject":"Envato Elite","topic_name":"All Marketplaces","content":"Vegemite is the best!!! We eat it on everything, especially pizza. Vegemite pizza is the best selling pizza in all of Australia!","updated_at":"Mon Jul 11 16:34:55 +1000 2011","site":"ActiveDen"},{"message_id":"386733","thread_id":"41337","thread_subject":"I know you envato! (sort of)","topic_name":"ThemeForest","content":"Collis wasn't too busy he just was in a meeting! He would have said Hi for sure. Truth be told I said \"just stick around until he's out\" but Guillherme was so scared of the Murloc he ran away!!!\r\n\r\nMurlocs are pretty scary. It's just lucky we only have one in the office.","updated_at":"Wed Mar 23 16:25:26 +1100 2011","site":"ThemeForest"},{"message_id":"386719","thread_id":"41337","thread_subject":"I know you envato! (sort of)","topic_name":"ThemeForest","content":"Guillherme popped in today, I thought he was a really nice guy!\r\n\r\nHe was such a good sport, he wore my Murloc on his head and everything!\r\n\r\n<img src=\"http://yeahnah.org/i/dd-studios-comes-to-envato.jpg\" />","updated_at":"Wed Mar 23 15:28:45 +1100 2011","site":"ThemeForest"},{"message_id":"386642","thread_id":"41337","thread_subject":"I know you envato! (sort of)","topic_name":"ThemeForest","content":"If someone were taking photos of my house and then started talking on an internet forum about coming over for a visit I would be scared :(\r\n\r\nI'd tell my Mum that I want her to come over to make me feel better.","updated_at":"Wed Mar 23 10:14:48 +1100 2011","site":"ThemeForest"},{"message_id":"282375","thread_id":"30038","thread_subject":"502 Bad Gateway on Envato websites","topic_name":"ThemeForest","content":"Hey everyone!\n\nIt's a known problem and we get SMS notifications when the sites throw 502s (so we can jump out of bed and fix it), it's only affecting the blogs and Tuts side of the business (not the Marketplaces).\n\nWe have a pretty darn good idea what is causing it, and have time scheduled in the next 2 weeks to get it sorted.\n\nWhen the problem occurs, most of the pages on all the sites should still be accessible (because they're cached).\n\nAnyway, it's a bit of a pain, it'll be sorted soon!","updated_at":"Thu Aug 12 10:31:30 +1000 2010","site":"ThemeForest"},{"message_id":"278299","thread_id":"29656","thread_subject":"Preview Image Sets Re-Launched","topic_name":"GraphicRiver","content":"Hallo!\r\n\r\nYep, our mistake, we're turning them off now!","updated_at":"Tue Aug 03 23:27:45 +1000 2010","site":"GraphicRiver"},{"message_id":"278274","thread_id":"29646","thread_subject":"Images are gone","topic_name":"GraphicRiver","content":"<blockquote>\r\n<blockquote>\r\nG'day,\r\n\r\nCan you confirm that this is now correct?\r\n\r\nhttp://themeforest.net/user/joelvardy/bookmarks\r\n\r\nRyan.\r\n</blockquote>\r\n\r\nYep that's great, thanks!! :D\r\n</blockquote>\r\n\r\nSweet! Party time!","updated_at":"Tue Aug 03 22:38:27 +1000 2010","site":"GraphicRiver"},{"message_id":"278267","thread_id":"29646","thread_subject":"Images are gone","topic_name":"GraphicRiver","content":"<blockquote>\r\n<blockquote>\r\nI noticed also some preview images are reverted to old ones.\r\n</blockquote>\r\n\r\nMy preview image and screenshots are reverted to old ones. Do I need reupload?\r\n</blockquote>\r\n\r\nCan you confirm that this is correct as well?\r\n\r\nhttp://themeforest.net/item/careera-resume-cv/110128\r\n\r\nRyan.","updated_at":"Tue Aug 03 22:19:29 +1000 2010","site":"GraphicRiver"},{"message_id":"278264","thread_id":"29646","thread_subject":"Images are gone","topic_name":"GraphicRiver","content":"<blockquote>\r\nHey ryan not sure if you are aware, the images are back for <a href=\"http://themeforest.net/user/joelvardy/bookmarks\">my bookmarks</a>.<br />\r\n- But they are the old ones, I updated the images about a month ago.\r\n</blockquote>\r\n\r\nG'day,\r\n\r\nCan you confirm that this is now correct?\r\n\r\nhttp://themeforest.net/user/joelvardy/bookmarks\r\n\r\nRyan.","updated_at":"Tue Aug 03 22:14:06 +1000 2010","site":"GraphicRiver"},{"message_id":"278257","thread_id":"29646","thread_subject":"Images are gone","topic_name":"GraphicRiver","content":"<blockquote>\r\n<blockquote>\r\nI noticed also some preview images are reverted to old ones.\r\n</blockquote>\r\n\r\nMy preview image and screenshots are reverted to old ones. Do I need reupload?\r\n</blockquote>\r\n\r\nNope you don't need to re-upload! They're still around they just forgot that they are!","updated_at":"Tue Aug 03 21:50:26 +1000 2010","site":"GraphicRiver"},{"message_id":"278254","thread_id":"29646","thread_subject":"Images are gone","topic_name":"GraphicRiver","content":"Hey everyone!\r\n\r\nWe think we've isolated the issue, report back in a tiny bit!","updated_at":"Tue Aug 03 21:48:38 +1000 2010","site":"GraphicRiver"},{"message_id":"278249","thread_id":"29646","thread_subject":"Images are gone","topic_name":"GraphicRiver","content":"<blockquote>\r\nHey ryan not sure if you are aware, the images are back for <a href=\"http://themeforest.net/user/joelvardy/bookmarks\">my bookmarks</a>.<br />\r\n- But they are the old ones, I updated the images about a month ago.\r\n</blockquote>\r\n\r\nThat doesn't sound right! The problems seem to be related, I'll keep you posted in this thread.","updated_at":"Tue Aug 03 21:37:06 +1000 2010","site":"GraphicRiver"},{"message_id":"278245","thread_id":"29646","thread_subject":"Images are gone","topic_name":"GraphicRiver","content":"<blockquote>\r\n<blockquote>\r\nHeyo!\r\n\r\nCollection images should all be sorted again, whoops!\r\n\r\nRyan.\r\n</blockquote>\r\nwho has been keelhauled this time ?\r\n</blockquote>\r\n\r\nNobody as far as I know. But if it was anybody it'd be me. Though you wouldn't want to try it. I have a rubber chicken and I'm not afraid to use it!!!\r\n\r\n!http://www.mediabistro.com/agencyspy/original/rubber_chicken.jpg!","updated_at":"Tue Aug 03 21:30:01 +1000 2010","site":"GraphicRiver"},{"message_id":"278244","thread_id":"29646","thread_subject":"Images are gone","topic_name":"GraphicRiver","content":"<blockquote>\r\n<blockquote>\r\nI noticed also some preview images are reverted to old ones.\r\n</blockquote>\r\n\r\nMy preview image and screenshots are reverted to old ones. Do I need reupload?\r\n</blockquote>\r\n\r\nYep! We're sorting that out too. You don't have to re-upload any images, they'll be fixed shortly!","updated_at":"Tue Aug 03 21:28:27 +1000 2010","site":"GraphicRiver"},{"message_id":"278215","thread_id":"29646","thread_subject":"Images are gone","topic_name":"GraphicRiver","content":"<blockquote>\r\nnot sure if it's related, seems like all the javascript  files are missing the live preview button where the preview image are.\r\n</blockquote>\r\n\r\nWorkin' on it!","updated_at":"Tue Aug 03 19:02:42 +1000 2010","site":"GraphicRiver"},{"message_id":"278205","thread_id":"29644","thread_subject":"Collections images reset","topic_name":"ActiveDen","content":"Hiya!\r\n\r\nThey should be all fixed now, whoops!\r\n\r\nRyan. :sunglasses:","updated_at":"Tue Aug 03 18:39:56 +1000 2010","site":"ActiveDen"},{"message_id":"278203","thread_id":"29646","thread_subject":"Images are gone","topic_name":"GraphicRiver","content":"Heyo!\r\n\r\nCollection images should all be sorted again, whoops!\r\n\r\nRyan.","updated_at":"Tue Aug 03 18:38:22 +1000 2010","site":"ThemeForest"},{"message_id":"278192","thread_id":"29644","thread_subject":"Collections images reset","topic_name":"ActiveDen","content":"Hey zefs!\r\n\r\nWhat do mean by the collection images being 'reset', do you mean they are displaying the default images?","updated_at":"Tue Aug 03 18:09:34 +1000 2010","site":"ActiveDen"},{"message_id":"216524","thread_id":"23370","thread_subject":"Having Problems on Tut sites?","topic_name":"All Marketplaces","content":"Hello people!\r\n\r\nYes there was a problem with searches displaying on the homepage but that has since been fixed. We have moved tuts to another host and we're using a different web server software and cache strategy.\r\n\r\nI think you should find them to be quite fast and stable from now on!\r\n\r\nCheers,\r\nRyan.","updated_at":"Fri Jul 23 14:11:21 +1000 2010","site":"ThemeForest"},{"message_id":"120087","thread_id":"13747","thread_subject":"A sad day","topic_name":"All Marketplaces","content":"Aw, thanks everyone!","updated_at":"Sat Jul 24 08:09:50 +1000 2010","site":"ActiveDen"}],"user":{"username":"ryan","country":"Australia","sales":"3","location":"Melbourne, Australia","image":"http://marketplace.envato.com/images/common/icons-buttons/default-user.jpg"}}